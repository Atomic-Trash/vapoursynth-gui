<UserControl x:Class="VapourSynthPortable.Controls.VideoPlayerControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="#000000"
             Loaded="UserControl_Loaded"
             Unloaded="UserControl_Unloaded"
             Focusable="True"
             KeyboardNavigation.TabNavigation="Once"
             FocusVisualStyle="{x:Null}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Video Surface -->
        <Grid Grid.Row="0">
            <!-- Host for mpv window -->
            <Border x:Name="VideoHost" Background="#000000"/>

            <!-- Placeholder when no video -->
            <StackPanel x:Name="PlaceholderPanel" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="No video loaded" FontSize="16" Foreground="#BBBBBB"
                           HorizontalAlignment="Center"/>
                <TextBlock x:Name="MpvStatusText" Text="" FontSize="11" Foreground="#DDDDDD"
                           HorizontalAlignment="Center" Margin="0,8,0,0"/>
            </StackPanel>

            <!-- Loading overlay -->
            <Border x:Name="LoadingOverlay" Background="#C0000000" Visibility="Collapsed">
                <TextBlock Text="Loading..." FontSize="14" Foreground="#FFFFFF"
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
        </Grid>

        <!-- Playback Controls -->
        <Border Grid.Row="1" Background="#252526" Padding="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Timeline Slider -->
                <Grid Grid.Row="0" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock x:Name="CurrentTimeText" Grid.Column="0" Text="00:00:00"
                               Foreground="#AAA" FontSize="11" VerticalAlignment="Center"
                               Margin="0,0,10,0" FontFamily="Consolas"/>

                    <Slider x:Name="TimelineSlider" Grid.Column="1"
                            Minimum="0" Maximum="100" Value="0"
                            VerticalAlignment="Center"
                            PreviewMouseDown="TimelineSlider_PreviewMouseDown"
                            PreviewMouseUp="TimelineSlider_PreviewMouseUp"
                            ValueChanged="TimelineSlider_ValueChanged"
                            ToolTip="Seek timeline (drag to position)"
                            AutomationProperties.Name="Timeline"
                            AutomationProperties.HelpText="Seek to a position in the video"/>

                    <TextBlock x:Name="DurationText" Grid.Column="2" Text="00:00:00"
                               Foreground="#AAA" FontSize="11" VerticalAlignment="Center"
                               Margin="10,0,0,0" FontFamily="Consolas"/>
                </Grid>

                <!-- Control Buttons -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Left Controls -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <Button x:Name="StepBackButton" Content="&#xE76B;" FontFamily="Segoe MDL2 Assets"
                                Style="{StaticResource SecondaryButton}" Padding="8,6" Margin="0,0,4,0"
                                Click="StepBackButton_Click" ToolTip="Step Backward (,)"
                                AutomationProperties.Name="Step Backward"
                                AutomationProperties.HelpText="Move one frame backward"/>
                        <Button x:Name="PlayPauseButton" Content="&#xE768;" FontFamily="Segoe MDL2 Assets"
                                Style="{StaticResource PrimaryButton}" Padding="12,8" Margin="0,0,4,0"
                                Click="PlayPauseButton_Click" ToolTip="Play/Pause (Space)"
                                AutomationProperties.Name="Play Pause"
                                AutomationProperties.HelpText="Toggle video playback"/>
                        <Button x:Name="StopButton" Content="&#xE71A;" FontFamily="Segoe MDL2 Assets"
                                Style="{StaticResource SecondaryButton}" Padding="8,6" Margin="0,0,4,0"
                                Click="StopButton_Click" ToolTip="Stop"
                                AutomationProperties.Name="Stop"
                                AutomationProperties.HelpText="Stop playback and return to start"/>
                        <Button x:Name="StepForwardButton" Content="&#xE76C;" FontFamily="Segoe MDL2 Assets"
                                Style="{StaticResource SecondaryButton}" Padding="8,6"
                                Click="StepForwardButton_Click" ToolTip="Step Forward (.)"
                                AutomationProperties.Name="Step Forward"
                                AutomationProperties.HelpText="Move one frame forward"/>
                    </StackPanel>

                    <!-- Center - Speed Control -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="Speed:" Foreground="#BBBBBB" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <ComboBox x:Name="SpeedCombo" Width="70" SelectedIndex="3"
                                  SelectionChanged="SpeedCombo_SelectionChanged"
                                  ToolTip="Playback speed (0.25x - 2x)"
                                  AutomationProperties.Name="Playback Speed"
                                  AutomationProperties.HelpText="Select playback speed from 0.25x to 2x">
                            <ComboBoxItem Content="0.25x"/>
                            <ComboBoxItem Content="0.5x"/>
                            <ComboBoxItem Content="0.75x"/>
                            <ComboBoxItem Content="1x"/>
                            <ComboBoxItem Content="1.25x"/>
                            <ComboBoxItem Content="1.5x"/>
                            <ComboBoxItem Content="2x"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- Right Controls - Volume -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <Button x:Name="MuteButton" Content="&#xE767;" FontFamily="Segoe MDL2 Assets"
                                Style="{StaticResource SecondaryButton}" Padding="8,6"
                                Click="MuteButton_Click" ToolTip="Mute (M)"
                                AutomationProperties.Name="Mute"
                                AutomationProperties.HelpText="Toggle audio mute"/>
                        <Slider x:Name="VolumeSlider" Width="80" Minimum="0" Maximum="100" Value="100"
                                VerticalAlignment="Center" Margin="8,0,0,0"
                                ValueChanged="VolumeSlider_ValueChanged"
                                ToolTip="Volume control (0-100%)"
                                AutomationProperties.Name="Volume"
                                AutomationProperties.HelpText="Adjust playback volume from 0 to 100 percent"/>
                        <TextBlock x:Name="VolumeText" Text="100%" Foreground="#BBBBBB" FontSize="11"
                                   VerticalAlignment="Center" Width="35" Margin="5,0,0,0"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</UserControl>
